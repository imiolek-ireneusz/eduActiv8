Bootstrap: docker
From: fedora:42

%post
    # Update the base system
    dnf -y update

    # Install basic dependencies
    dnf -y install wget dnf-plugins-core python3 python3-pygame
    dnf -y install libX11 SDL2 SDL2_ttf mesa-dri-drivers xorg-x11-xauth

    # Install eSpeak for TTS support
    dnf -y install espeak

    # Add the OpenSUSE Build Service repo for eduActiv8 (Fedora 42)
    dnf config-manager addrepo \
      --from-repofile=https://download.opensuse.org/repositories/home:imiolek-i/Fedora_42/home:imiolek-i.repo
    
    # Install eduActiv8 from the OBS repo
    dnf -y install eduactiv8

    # Clean up caches for a smaller image
    dnf clean all

%environment
    # Set the locale and language
    export LANG=C.UTF-8
    export LC_ALL=C.UTF-8

%labels
    Author Paul Zakharov
    Version v1.0
    Description "eduActiv8 with eSpeak in a Fedora 42 Apptainer container"

%help
    This Apptainer image runs eduActiv8 with eSpeak installed for TTS.
    To launch, use: apptainer run /path/to/your/image.sif

%runscript
    exec eduactiv8

